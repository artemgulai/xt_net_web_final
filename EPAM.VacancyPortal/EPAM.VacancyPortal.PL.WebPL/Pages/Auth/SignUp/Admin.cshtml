@using EPAM.VacancyPortal.PL.WebPL.Models;
@using EPAM.VacancyPortal.Entities;

@{
    Page.Title = "Title goes here";
    Layout = "~/Layouts/_MainLayout.cshtml";
}

<div class="content-container">
    <div class="center">
        <form action="#" method="post">
            <div class="form-row">
                <div class="form-group col">
                    <input type="text" class="form-control" name="Login" placeholder="Login">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col">
                    <input type="password" class="form-control" name="Password" placeholder="Password">
                </div>
                <div class="form-group col">
                    <input type="password" class="form-control" name="RepeatPassword" placeholder="Repeat password">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group col">
                    <button class="btn btn-block btn-primary" type="submit">Sign up</button>
                </div>
            </div>
        </form>

        @if (IsPost)
        {
            string login = Request.Form["Login"];
            string password = Request.Form["Password"];
            string repeatPassword = Request.Form["RepeatPassword"];

            if (password != repeatPassword)
            {
                <div class="alert alert-danger text-center">
                    Passwords don't match
                </div>
                return;
            }

            int id = AdminService.Register(new Admin
            {
                Login = login,
                Password = password,
                IsCandidate = true,
                Role = "ADMIN"
            });

            if (id != 0)
            {
                <div class="alert alert-info">
                    You have registered. Wait for approvement from administrator.
                </div>
            }
            else
            {
                <div class="alert alert-info">
                    You cannot register with such login.
                </div>
            }
        }
    </div>
</div>